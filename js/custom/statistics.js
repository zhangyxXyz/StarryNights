var start_date="20220101",date=new Date,end_date=""+date.getFullYear()+(date.getMonth()>8?date.getMonth()+1:"0"+(date.getMonth()+1))+(date.getDate()>9?date.getDate():"0"+date.getDate()),site_id="17932610",dataUrl="https://baidu-statistics-api-zzzyx.vercel.app/api?site_id="+site_id,metrics="pv_count",metricsName="pv_count"===metrics?"访问次数":"visitor_count"===metrics?"访客数":"",itemtheme=document.getElementById("theme_mode_content"),visit_calendar=function(t,e){var n=new Date,i=""+n.getFullYear()+(n.getMonth()>8?n.getMonth()+1:"0"+(n.getMonth()+1))+(n.getDate()>9?n.getDate():"0"+n.getDate());n.setFullYear(n.getFullYear()-1),n.setTime(n.getTime()-864e5*n.getDay());var a=""+n.getFullYear()+(n.getMonth()>8?n.getMonth()+1:"0"+(n.getMonth()+1))+(n.getDate()>9?n.getDate():"0"+n.getDate()),o="pv_count"===t?"次":"visitor_count"===t?"人":"",r=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],l=[],s="",c="",d="",p="",m=0,u=0,h=[],g=[],f=[],v=[],x=0,y=0,b=[],w=[],_=[],S=0;function C(){var t,n,i,a,o,r,s,c,d,p,m=window.devicePixelRatio||1,u=document.getElementById("visit_tooltip_container"),g="",f="",v="",x="";document.getElementById("visitcanvas")&&function(){for(r in(t=document.getElementById("visitcanvas")).style.width="100%",t.style.height="",document.getElementById("visitmessage"),n=t.getContext("2d"),width=t.width=document.getElementById("visitcalendarcanvasbox").offsetWidth,height=t.height=8.64*t.width/visit_data.length,function(t,e,n){if(n>1){var i=t.width,a=t.height;t.width=i*n,t.height=a*n,t.style.width="100%",t.style.height=a+"px",e.scale(n,n)}}(t,n,m),i=height/9,a=.8*i,o={x:.02*width,y:.025*width},visit_data){for(s in weekdata=visit_data[r],weekdata)c={date:"",count:"",x:0,y:0},h.push(c),n.fillStyle=L(e,weekdata[s].count),o.y=Math.round(100*o.y)/100,c.date=weekdata[s].date,c.count=weekdata[s].count,c.x=o.x,c.y=o.y,n.fillRect(o.x,o.y,a,a),o.y=o.y+i;o.y=.025*width,o.x=o.x+i}if(document.body.clientWidth>700)for(p in n.font="600  Arial",n.fillStyle="#aaa",n.fillText("日",0,1.9*i),n.fillText("二",0,3.9*i),n.fillText("四",0,5.9*i),n.fillText("六",0,7.9*i),d=width/24,l)n.fillText(l[p],d,.7*i),d+=width/12;t.onmousemove=function(e){document.querySelector(".visitmessage")&&(u.innerHTML=""),function(t,e){var n=t.getBoundingClientRect(),i=e.clientX-n.left*(t.width/n.width),o=e.clientY-n.top*(t.height/n.height),r=!0,l=!1,s=void 0;try{for(var c,d=h[Symbol.iterator]();!(r=(c=d.next()).done);r=!0){var p=c.value,m=i-p.x,y=o-p.y;0<m&&m<a&&0<y&&y<a&&(v=p.date,x=p.count,g=e.clientX-100,f=e.clientY-60,html=O(g,f,v,x),append_div_visitcalendar(u,html))}}catch(t){l=!0,s=t}finally{try{!r&&d.return&&d.return()}finally{if(l)throw s}}}(t,e)},u.onmousemove=function(t){document.querySelector(".visitmessage")&&(u.innerHTML="")}}()}function E(){0===y?(k(52),k(51),k(50),k(49),k(48),x+=b[6].count,d=b[6].date):(k(52),k(51),k(50),k(49),function(){for(var t=y-1;t<w.length;t++)x+=w[t].count}(),d=w[y-1].date)}function k(t){var e=!0,n=!1,i=void 0;try{for(var a,o=visit_data[t][Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var r=a.value;x+=r.count}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}function B(){var t=!0,e=!1,n=void 0;try{for(var i,a=f[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;m+=o.count}}catch(t){e=!0,n=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw n}}}function I(t){6===y?(p=f[0].date,B()):(lastweek=t.contributions[51],p=lastweek[y+1].date,B(),function(){for(var t=y;t<v.length;t++)m+=v[t].count}())}function T(t,e){for(var n=[],i=0;i<t.length;)n.push(t.slice(i,i+=e));return n}fetch(dataUrl+"&method=overview/getTimeTrendRpt&metrics="+t+"&start_date="+a+"&end_date="+i).then((function(t){return t.json()})).then((function(t){for(var n=t.result.items[0],i=t.result.items[1],a=0,o=[],h=0;h<n.length;h++)"--"!==i[h][0]?(o.push({date:n[h][0].replace(/\//g,"-"),count:i[h][0]}),a+=i[h][0]):o.push({date:n[h][0].replace(/\//g,"-"),count:0});var k={total:a,contributions:T(o,7)};visit_data=k.contributions,u=k.total,w=visit_data[48],b=visit_data[47],g=k.contributions[0],f=k.contributions[52],v=k.contributions[51],y=f.length-1,c=f[y].date,s=g[0].date,S=1*c.substring(5,7),_=r.splice(S,12-S),l=_.concat(r),I(k),E();var B=z(l,visit_data,e,u,x,m,s,c,p,d);append_div_visitcalendar(document.getElementById("visit_container"),B),document.getElementById("visit_loading")&&document.getElementById("visit_loading").remove(),C()})).catch((function(t){console.log(t)})),window.onresize=function(){C()},window.onscroll=function(){document.querySelector(".visitmessage")&&(visit_tooltip_container.innerHTML="")};var L=function(e,n){if("pv_count"===t){if(0===n){parseInt(n/20);return e[0]}return n<20?e[1]:n<200?e[parseInt(n/20)]:e[9]}if(0===n){parseInt(n/2);return e[0]}return n<2?e[1]:n<20?e[parseInt(n/2)]:e[9]},O=function(t,e,n,i){var a="";return a+='<div class="visitmessage" style="top:'+e+"px;left:"+t+'px;position: fixed;z-index:9999"><div class="angle-wrapper" style="display:block;"><span>'+n+"&nbsp;</span><span>"+i+" "+o+"访问</span></div></div>"},z=function(t,e,n,i,a,o,r,l,s,c){var d="",p=function(t){var e="";return e+'<div id="visit_tooltip_container"></div><div class="contrib-footer clearfix mt-1 mx-3 px-3 pb-1"><div class="float-left text-gray">数据来源 <a href="https://tongji.baidu.com/" target="blank">百度统计</a></div><div class="contrib-legend text-gray">Less <ul class="legend"><li style="background-color:'+t[0]+'"></li><li style="background-color:'+t[2]+'"></li><li style="background-color:'+t[4]+'"></li><li style="background-color:'+t[6]+'"></li><li style="background-color:'+t[8]+'"></li></ul>More </div></div>'}(n);return d+='<div class="position-relative"><div><span class="visit_title">博客访问日历</span></div><div class="border py-2 graph-before-activity-overview"><div class="js-visitcalendar-graph mx-md-2 mx-3 d-flex flex-column flex-items-end flex-xl-items-center overflow-hidden pt-1 is-graph-loading graph-canvas visitcalendar-graph height-full text-center"><div id="visitcalendarcanvasbox"> <canvas id="visitcanvas" style="animation: none;"></canvas></div></div>'+p+"</div></div>",d+='<div style="display:flex;width:100%"><div class="contrib-column contrib-column-first table-column"><span class="text-muted">过去一年访问</span><span class="contrib-number">'+i+'</span><span class="text-muted">'+r+"&nbsp;-&nbsp;"+l+'</span></div><div class="contrib-column table-column"><span class="text-muted">最近一月访问</span><span class="contrib-number">'+a+'</span><span class="text-muted">'+c+"&nbsp;-&nbsp;"+l+'</span></div><div class="contrib-column table-column"><span class="text-muted">最近一周访问</span><span class="contrib-number">'+o+'</span><span class="text-muted">'+s+"&nbsp;-&nbsp;"+l+"</span></div></div>"+M()},M=function(){return style='<style>.md ul>li::before{content: none} #visit_container{text-align:center;margin:0 auto;width:100%;padding:10px;display:flex;display:-webkit-flex;justify-content:center;align-items:center;flex-wrap:wrap;}.visit_title{font-size:1rem;font-weight:550;}.visitcalendar-graph text.wday,.visitcalendar-graph text.month{font-size:10px;fill:#aaa;}.contrib-legend{text-align:right;padding:0 14px 10px 0;display:inline-block;float:right;}.contrib-legend .legend{display:inline-block;list-style:none;margin:0 5px;position:relative;bottom:-7px;padding:0;}.contrib-legend .legend li{display:inline-block;width:10px;height:10px;}.text-small{font-size:12px;color:#767676;}.visitcalendar-graph{padding:15px 0 0;text-align:center;}.contrib-column{text-align:center;border-left:1px solid #ddd;border-top:1px solid #ddd;}.contrib-column-first{border-left:0;}.table-column{padding:10px;display:table-cell;flex:1;vertical-align:top;}.contrib-number{font-weight:400;line-height:1.3em;font-size:24px;display:block;}.visitcalendar img.spinner{width:70px;margin-top:50px;min-height:70px;}.monospace{text-align:center;color:#000;font-family:monospace;}.monospace a{color:#1D75AB;text-decoration:none;}.contrib-footer{font-size:11px;padding:0 10px 12px;text-align:left;width:100%;box-sizing:border-box;height:26px;}.left.text-muted{float:left;margin-left:9px;color:#767676;}.left.text-muted a{color:#4078c0;text-decoration:none;}.left.text-muted a:hover,.monospace a:hover{text-decoration:underline;}h2.f4.text-normal.mb-3{display:none;}.float-left.text-gray{float:left;}#user-activity-overview{display:none;}.day-tooltip{white-space:nowrap;position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.85);border-radius:3px;display:none;pointer-events:none;}.day-tooltip strong{color:#dfe2e5;}.day-tooltip.is-visible{display:block;}.day-tooltip:after{position:absolute;bottom:-10px;left:50%;width:5px;height:5px;box-sizing:border-box;margin:0 0 0 -5px;content:" ";border:5px solid transparent;border-top-color:rgba(0,0,0,.85)}.position-relative{width:100%;}@media screen and (max-width:650px){.contrib-column{display:none}}.angle-wrapper{z-index:9999;display:inline;width:200px;height:40px;position:relative;padding:5px 0;background:rgba(0,0,0,0.8);border-radius:8px;text-align:center;color:white;}.angle-box{position:fixed;padding:10px}.angle-wrapper span{padding-bottom:1em;}.angle-wrapper:before{content:"";width:0;height:0;border:10px solid transparent;border-top-color:rgba(0,0,0,0.8);position:absolute;left:47.5%;top:100%;}</style>',style}},append_div_visitcalendar=function(t,e){if(null!==t)if("string"==typeof e){var n=document.createElement("div");n.innerHTML=e;for(var i=document.createDocumentFragment();n.firstChild;)i.appendChild(n.firstChild);t.appendChild(i)}else t.appendChild(e)},loading_visit=function(t){return'<div id="visit_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="'+t+'" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div>'};function mapChart(){var t=document.createElement("script");fetch(dataUrl+("&start_date="+start_date+"&end_date="+end_date+"&metrics="+metrics+"&method=visit/district/a")).then((function(t){return t.json()})).then((function(e){for(var n=itemtheme&&itemtheme.getAttribute("class").indexOf("i-sun")>-1?"#4c4948":"rgba(255,255,255,0.8)",i=e.result.items[0],a=e.result.items[1],o=[],r=a[0][0],l=0;l<i.length;l++)o.push({name:i[l][0].name,value:a[l][0]});var s=JSON.stringify(o);t.innerHTML="\n      var mapChart = echarts.init(document.getElementById('map-chart'), 'light');\n      var mapOption = {\n        title: {\n          text: '博客访问来源地图',\n          x: 'center',\n          textStyle: {\n            color: '".concat(n,"'\n          }\n        },\n        tooltip: {\n          trigger: 'item'\n        },\n        visualMap: {\n          min: 0,\n          max: ").concat(r,",\n          left: 'left',\n          top: 'bottom',\n          text: ['高','低'],\n          color: ['#49b1f5', '#92d0f9'],\n          textStyle: {\n            color: '").concat(n,"'\n          },\n          calculable: true\n        },\n        series: [{\n          name: '").concat(metricsName,"',\n          type: 'map',\n          mapType: 'china',\n          showLegendSymbol: false,\n          label: {\n            normal: {\n              show: false\n            },\n            emphasis: {\n              show: true,\n              color: '#617282'\n            }\n          },\n          itemStyle: {\n            normal: {\n              areaColor: 'rgb(230, 232, 234)',\n              borderColor: 'rgb(255, 255, 255)',\n              borderWidth: 1\n            },\n            emphasis: {\n              areaColor: 'gold'\n            }\n          },\n          data: ").concat(s,'\n        }]\n      };\n      mapChart.setOption(mapOption);\n      window.addEventListener("resize", () => {\n        mapChart.resize();\n      });'),document.getElementById("map-chart").after(t)})).catch((function(t){console.log(t)}))}function trendsChart(){var t=document.createElement("script");fetch(dataUrl+("&start_date="+start_date+"&end_date="+end_date+"&metrics="+metrics+"&method=trend/time/a&gran=month")).then((function(t){return t.json()})).then((function(e){for(var n=itemtheme&&itemtheme.getAttribute("class").indexOf("i-sun")>-1?"#4c4948":"rgba(255,255,255,0.8)",i=[],a=[],o=e.result.items[0],r=e.result.items[1],l=o.length-1;l>=0;l--)i.push(o[l][0].substring(0,7).replace("/","-")),a.push("--"!==r[l][0]?r[l][0]:0);var s=JSON.stringify(i),c=JSON.stringify(a);t.innerHTML="\n      var trendsChart = echarts.init(document.getElementById('trends-chart'), 'light');\n      var trendsOption = {\n        title: {\n          text: '博客访问统计图',\n          x: 'center',\n          textStyle: {\n            color: '".concat(n,"'\n          }\n        },\n        tooltip: {\n          trigger: 'axis'\n        },\n        xAxis: {\n          name: '日期',\n          type: 'category',\n          boundaryGap: false,\n          nameTextStyle: {\n            color: '").concat(n,"'\n          },\n          axisTick: {\n            show: false\n          },\n          axisLabel: {\n            show: true,\n            color: '").concat(n,"'\n          },\n          axisLine: {\n            show: true,\n            lineStyle: {\n              color: '").concat(n,"'\n            }\n          },\n          data: ").concat(s,"\n        },\n        yAxis: {\n          name: '").concat(metricsName,"',\n          type: 'value',\n          nameTextStyle: {\n            color: '").concat(n,"'\n          },\n          splitLine: {\n            show: false\n          },\n          axisTick: {\n            show: false\n          },\n          axisLabel: {\n            show: true,\n            color: '").concat(n,"'\n          },\n          axisLine: {\n            show: true,\n            lineStyle: {\n              color: '").concat(n,"'\n            }\n          }\n        },\n        series: [{\n          name: '").concat(metricsName,"',\n          type: 'line',\n          smooth: true,\n          lineStyle: {\n              width: 0\n          },\n          showSymbol: false,\n          itemStyle: {\n            opacity: 1,\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: 'rgba(128, 255, 165)'\n            },\n            {\n              offset: 1,\n              color: 'rgba(1, 191, 236)'\n            }])\n          },\n          areaStyle: {\n            opacity: 1,\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: 'rgba(128, 255, 165)'\n            }, {\n              offset: 1,\n              color: 'rgba(1, 191, 236)'\n            }])\n          },\n          data: ").concat(c,",\n          markLine: {\n            data: [{\n              name: '平均值',\n              type: 'average',\n              label: {\n                color: '").concat(n,'\'\n              }\n            }]\n          }\n        }]\n      };\n      trendsChart.setOption(trendsOption);\n      window.addEventListener("resize", () => {\n        trendsChart.resize();\n      });'),document.getElementById("trends-chart").after(t)})).catch((function(t){console.log(t)}))}function sourcesChart(){var t=document.createElement("script");fetch(dataUrl+("&start_date="+start_date+"&end_date="+end_date+"&metrics="+metrics+"&method=source/all/a")).then((function(t){return t.json()})).then((function(e){for(var n=itemtheme&&itemtheme.getAttribute("class").indexOf("i-sun")>-1?"#4c4948":"rgba(255,255,255,0.8)",i=e.result.items[0],a=e.result.items[1],o=[],r=0;r<i.length;r++)o.push({name:i[r][0].name,value:a[r][0]});var l=JSON.stringify(o);t.innerHTML="\n      var sourcesChart = echarts.init(document.getElementById('sources-chart'), 'light');\n      var sourcesOption = {\n        title: {\n          text: '博客访问来源统计图',\n          x: 'center',\n          textStyle: {\n            color: '".concat(n,"'\n          }\n        },\n        legend: {\n          top: 'bottom',\n          textStyle: {\n            color: '").concat(n,"'\n          }\n        },\n        tooltip: {\n          trigger: 'item'\n        },\n        series: [{\n          name: '").concat(metricsName,"',\n          type: 'pie',\n          radius: [30, 80],\n          center: ['50%', '50%'],\n          roseType: 'area',\n          label: {\n            color: '").concat(n,'\',\n            formatter: "{b} : {c} ({d}%)"\n          },\n          data: ').concat(l,",\n          itemStyle: {\n            emphasis: {\n              shadowBlur: 10,\n              shadowOffsetX: 0,\n              shadowColor: 'rgba(255, 255, 255, 0.5)'\n            }\n          }\n        }]\n      };\n      sourcesChart.setOption(sourcesOption);\n      window.addEventListener(\"resize\", () => {\n        sourcesChart.resize();\n      });"),document.getElementById("sources-chart").after(t)})).catch((function(t){console.log(t)}))}function switchStatisticsChartColor(){var t=document.getElementById("theme_mode_content"),e=t&&t.getAttribute("class").indexOf("i-sun")>-1?"#4c4948":"rgba(255,255,255,0.8)";if(document.getElementById("map-chart"))try{var n=mapOption;n.title.textStyle.color=e,n.visualMap.textStyle.color=e,mapChart.setOption(n)}catch(t){console.log(t)}if(document.getElementById("trends-chart"))try{var i=trendsOption;i.title.textStyle.color=e,i.xAxis.nameTextStyle.color=e,i.yAxis.nameTextStyle.color=e,i.xAxis.axisLabel.color=e,i.yAxis.axisLabel.color=e,i.xAxis.axisLine.lineStyle.color=e,i.yAxis.axisLine.lineStyle.color=e,i.series[0].markLine.data[0].label.color=e,trendsChart.setOption(i)}catch(t){console.log(t)}if(document.getElementById("sources-chart"))try{var a=sourcesOption;a.title.textStyle.color=e,a.legend.textStyle.color=e,a.series[0].label.color=e,sourcesChart.setOption(a)}catch(t){console.log(t)}}!function(){var t=document.getElementById("visit_container"),e=(document.getElementById("visit_loading"),["#d7dbe2","#fdcdec","#fc9bd9","#fa6ac5","#f838b2","#f5089f","#c4067e","#92055e","#540336","#48022f","#30021f"]);append_div_visitcalendar(t,loading_visit(e[4])),visit_calendar("pv_count",e)}(),document.getElementById("map-chart")&&mapChart(),document.getElementById("trends-chart")&&trendsChart(),document.getElementById("sources-chart")&&sourcesChart(),document.getElementById("theme_mode_container").addEventListener("click",(function(){setTimeout(switchStatisticsChartColor,1e3)}));